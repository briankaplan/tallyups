<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0a0a0f">
  <title>Receipt Library - Tallyups</title>
  <link rel="apple-touch-icon" href="/static/apple-touch-icon.png">
  <link rel="manifest" href="/static/manifest.json">
  <link rel="stylesheet" href="/static/css/design-system.css">
  <link rel="stylesheet" href="/static/css/receipt-library-extracted.css">
  <script src="/static/js/unified-header.js"></script>
  <script src="/static/js/app-shell.js" defer></script>
  <script src="/static/js/design-system.js"></script>
</head>
<body class="dark-mode">
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H6v-2h6v2zm4-4H6v-2h10v2zm0-4H6V7h10v2z"/>
          </svg>
          Receipt Library
        </div>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Library</div>
          <a href="#" class="nav-item active" data-filter="all">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"></rect>
              <line x1="9" y1="9" x2="15" y2="9"></line>
              <line x1="9" y1="13" x2="15" y2="13"></line>
            </svg>
            <span>All Receipts</span>
            <span class="nav-count" id="count-all">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="favorites">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>
            <span>Favorites</span>
            <span class="nav-count" id="count-favorites">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="recent">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <span>Recent</span>
            <span class="nav-count" id="count-recent">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="needs_review">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="12"></line>
              <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <span>Needs Review</span>
            <span class="nav-count warning" id="count-review">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="duplicates">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="8" y="8" width="12" height="12" rx="2"></rect>
              <rect x="4" y="4" width="12" height="12" rx="2"></rect>
            </svg>
            <span>Duplicates</span>
            <span class="nav-count" id="count-duplicates">0</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Business</div>
          <a href="#" class="nav-item" data-filter="business:down_home">
            <span class="business-dot down-home"></span>
            <span>Down Home</span>
            <span class="nav-count" id="count-down-home">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="business:mcr">
            <span class="business-dot mcr"></span>
            <span>Music City Rodeo</span>
            <span class="nav-count" id="count-mcr">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="business:personal">
            <span class="business-dot personal"></span>
            <span>Personal</span>
            <span class="nav-count" id="count-personal">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="business:ceo">
            <span class="business-dot ceo"></span>
            <span>CEO</span>
            <span class="nav-count" id="count-ceo">0</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Status</div>
          <a href="#" class="nav-item" data-filter="status:verified">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>Verified</span>
            <span class="nav-count" id="count-verified">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="status:matched">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
              <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
            </svg>
            <span>Matched</span>
            <span class="nav-count" id="count-matched">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="status:processing">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <span>Processing</span>
            <span class="nav-count" id="count-processing">0</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Source</div>
          <a href="#" class="nav-item" data-filter="source:gmail">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"/>
            </svg>
            <span>Gmail</span>
            <span class="nav-count" id="count-gmail">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="source:scanner">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"></rect>
              <line x1="3" y1="9" x2="21" y2="9"></line>
            </svg>
            <span>Scanner</span>
            <span class="nav-count" id="count-scanner">0</span>
          </a>
          <a href="#" class="nav-item" data-filter="source:upload">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            <span>Uploads</span>
            <span class="nav-count" id="count-upload">0</span>
          </a>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <button class="menu-btn" id="menu-btn" aria-label="Menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>

        <!-- App Shell provides navigation -->

        <div class="search-container">
          <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
          <input type="text" class="search-input" id="search-input" placeholder="Search receipts... (try 'coffee >$10 last-month')" autocomplete="off">
          <button class="search-clear" id="search-clear">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
          <span class="search-shortcut" id="search-shortcut">/</span>
        </div>

        <div class="header-actions">
          <div class="view-toggle">
            <button class="view-btn active" data-view="grid" title="Grid view">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                <rect x="3" y="14" width="7" height="7" rx="1"></rect>
                <rect x="14" y="14" width="7" height="7" rx="1"></rect>
              </svg>
            </button>
            <button class="view-btn" data-view="list" title="List view">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="8" y1="6" x2="21" y2="6"></line>
                <line x1="8" y1="12" x2="21" y2="12"></line>
                <line x1="8" y1="18" x2="21" y2="18"></line>
                <circle cx="4" cy="6" r="1" fill="currentColor"></circle>
                <circle cx="4" cy="12" r="1" fill="currentColor"></circle>
                <circle cx="4" cy="18" r="1" fill="currentColor"></circle>
              </svg>
            </button>
            <button class="view-btn" data-view="timeline" title="Timeline view">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="2" x2="12" y2="22"></line>
                <circle cx="12" cy="6" r="2"></circle>
                <circle cx="12" cy="12" r="2"></circle>
                <circle cx="12" cy="18" r="2"></circle>
              </svg>
            </button>
          </div>

          <button class="header-btn" id="filter-btn" title="Filters">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
            </svg>
          </button>

          <button class="header-btn" id="sort-btn" title="Sort">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18M6 12h12M9 18h6"></path>
            </svg>
          </button>

          <button class="header-btn primary" id="upload-btn" title="Upload receipts">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
          </button>

          <button class="header-btn" id="theme-btn" title="Toggle theme">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>

          <a href="/logout" class="header-btn" title="Logout" style="text-decoration:none;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
          </a>
        </div>
      </header>

      <!-- Toolbar -->
      <div class="toolbar">
        <div class="toolbar-left">
          <span class="results-count" id="results-count">Loading...</span>
        </div>
        <div class="toolbar-right">
          <span class="total-amount" id="total-amount"></span>
        </div>
      </div>

      <!-- Filter Chips -->
      <div class="filter-chips" id="filter-chips">
        <button class="filter-chip active" data-filter="all">All</button>
        <button class="filter-chip" data-preset="today">Today</button>
        <button class="filter-chip" data-preset="week">This Week</button>
        <button class="filter-chip" data-preset="month">This Month</button>
        <button class="filter-chip" data-status="verified">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Verified
        </button>
        <button class="filter-chip" data-status="needs_review">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Needs Review
        </button>
        <button class="filter-chip" data-status="mismatch">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
          Mismatched
        </button>
      </div>

      <!-- Receipts Container -->
      <div class="receipts-container" id="receipts-container">
        <!-- Loading State -->
        <div class="loading-container" id="loading">
          <div class="loading-spinner"></div>
          <span>Loading receipts...</span>
        </div>

        <!-- Receipt Grid -->
        <div class="receipt-grid" id="receipt-grid"></div>

        <!-- Receipt List -->
        <div class="receipt-list" id="receipt-list"></div>

        <!-- Timeline View -->
        <div class="timeline-view" id="timeline-view"></div>

        <!-- Empty State - Enhanced with guidance -->
        <div class="empty-state hidden" id="empty-state">
          <div class="empty-illustration">
            <svg viewBox="0 0 120 120" fill="none" class="empty-svg">
              <!-- Receipt shape -->
              <rect x="35" y="20" width="50" height="70" rx="4" fill="rgba(0, 255, 136, 0.1)" stroke="var(--accent)" stroke-width="2" stroke-dasharray="4 2"/>
              <!-- Lines on receipt -->
              <line x1="45" y1="35" x2="75" y2="35" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round"/>
              <line x1="45" y1="45" x2="70" y2="45" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round"/>
              <line x1="45" y1="55" x2="65" y2="55" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round"/>
              <line x1="45" y1="70" x2="75" y2="70" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"/>
              <!-- Plus circle -->
              <circle cx="85" cy="75" r="18" fill="var(--accent)"/>
              <line x1="85" y1="67" x2="85" y2="83" stroke="#000" stroke-width="3" stroke-linecap="round"/>
              <line x1="77" y1="75" x2="93" y2="75" stroke="#000" stroke-width="3" stroke-linecap="round"/>
              <!-- Floating elements -->
              <circle cx="25" cy="40" r="4" fill="rgba(0, 255, 136, 0.3)" class="float-1"/>
              <circle cx="100" cy="30" r="3" fill="rgba(74, 158, 255, 0.3)" class="float-2"/>
              <circle cx="30" cy="90" r="5" fill="rgba(255, 165, 2, 0.3)" class="float-3"/>
            </svg>
          </div>
          <h3 id="empty-title">No receipts yet</h3>
          <p id="empty-message">Start building your receipt library! Here's how:</p>
          <div class="empty-tips">
            <div class="empty-tip">
              <span class="tip-icon">ðŸ“¸</span>
              <span class="tip-text">Scan receipts with your camera</span>
            </div>
            <div class="empty-tip">
              <span class="tip-icon">ðŸ“§</span>
              <span class="tip-text">Auto-import from Gmail</span>
            </div>
            <div class="empty-tip">
              <span class="tip-icon">ðŸ“¤</span>
              <span class="tip-text">Drag & drop files here</span>
            </div>
          </div>
          <div class="empty-actions">
            <button class="empty-action primary" id="empty-scan-btn" onclick="window.location='/scanner'">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
              </svg>
              Scan Receipt
            </button>
            <button class="empty-action secondary" id="empty-upload-btn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
              </svg>
              Upload Files
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Detail Modal Backdrop - click to close -->
  <div class="detail-backdrop" id="detail-backdrop" onclick="closeDetailPanel()"></div>

  <!-- Floating Close Button - always visible when modal is open -->
  <button class="detail-close-float" id="detail-close-float" onclick="closeDetailPanel()" title="Close (Esc)">âœ•</button>

  <!-- Detail Modal -->
  <div class="detail-modal" id="detail-modal">
    <div class="detail-header" style="position:sticky; top:0; z-index:10;">
      <button class="back-btn" id="detail-close" style="display:flex; align-items:center; gap:6px; padding:10px;" onclick="closeDetailPanel()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m15 18-6-6 6-6"></path>
        </svg>
        Back
      </button>
      <button id="detail-close-x" onclick="closeDetailPanel()" style="position:absolute; right:16px; top:50%; transform:translateY(-50%); background:rgba(255,255,255,0.1); border:none; width:36px; height:36px; border-radius:50%; cursor:pointer; display:flex; align-items:center; justify-content:center; color:#fff; font-size:20px;">âœ•</button>
      <div class="detail-actions">
        <button id="detail-favorite" title="Favorite">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
        </button>
        <button id="detail-download" title="Download">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
        </button>
        <button id="detail-share" title="Share">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
            <polyline points="16 6 12 2 8 6"></polyline>
            <line x1="12" y1="2" x2="12" y2="15"></line>
          </svg>
        </button>
        <button id="detail-delete" class="danger" title="Delete">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
        </button>
      </div>
    </div>

    <div class="detail-body">
      <div class="detail-image" id="detail-image">
        <img id="detail-img" src="" alt="Receipt">
      </div>

      <div class="detail-content">
        <h1 class="detail-merchant" id="detail-merchant"></h1>
        <div class="detail-source-badge" id="detail-source"></div>
        <div class="detail-amount" id="detail-amount"></div>

        <div class="detail-fields" id="detail-fields">
          <div class="detail-field">
            <span class="field-label">Date</span>
            <span class="field-value" id="detail-date"></span>
          </div>
          <div class="detail-field">
            <span class="field-label">Business</span>
            <span class="field-value" id="detail-business"></span>
          </div>
          <div class="detail-field">
            <span class="field-label">Status</span>
            <span class="field-value" id="detail-status"></span>
          </div>
          <div class="detail-field" id="field-card" style="display: none;">
            <span class="field-label">Card</span>
            <span class="field-value" id="detail-card"></span>
          </div>
          <div class="detail-field" id="field-category" style="display: none;">
            <span class="field-label">Category</span>
            <span class="field-value" id="detail-category"></span>
          </div>
          <div class="detail-field" id="field-linked" style="display: none;">
            <span class="field-label">Linked To</span>
            <span class="field-value" id="detail-linked" style="color: var(--accent);"></span>
          </div>
          <div class="detail-field" id="field-ocr" style="display: none;">
            <span class="field-label">OCR Data</span>
            <span class="field-value" id="detail-ocr" style="font-size: 12px; color: var(--text-secondary);"></span>
          </div>
        </div>

        <div class="detail-notes" id="detail-notes" style="display: none;">
          <h4>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            AI Notes
          </h4>
          <p id="detail-notes-text"></p>
        </div>

        <div class="detail-tags" id="detail-tags-section">
          <h4>Tags</h4>
          <div class="tags-list" id="detail-tags">
            <span class="tag add-tag">+ Add tag</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Modal -->
  <div class="filter-modal" id="filter-modal">
    <div class="filter-sheet">
      <div class="filter-sheet-header">
        <h3>Filters</h3>
        <button id="filter-modal-close">Done</button>
      </div>

      <div class="filter-section">
        <h4>Date Range</h4>
        <div class="filter-presets">
          <button class="filter-preset" data-preset="today">Today</button>
          <button class="filter-preset" data-preset="week">This Week</button>
          <button class="filter-preset" data-preset="month">This Month</button>
          <button class="filter-preset" data-preset="quarter">90 Days</button>
          <button class="filter-preset" data-preset="year">This Year</button>
          <button class="filter-preset" data-preset="all">All Time</button>
        </div>
        <div class="filter-inputs">
          <div class="filter-input-group">
            <label>From</label>
            <input type="date" id="filter-date-from">
          </div>
          <div class="filter-input-group">
            <label>To</label>
            <input type="date" id="filter-date-to">
          </div>
        </div>
      </div>

      <div class="filter-section">
        <h4>Amount Range</h4>
        <div class="filter-presets">
          <button class="filter-preset" data-amount="0-25">Under $25</button>
          <button class="filter-preset" data-amount="25-100">$25 - $100</button>
          <button class="filter-preset" data-amount="100-500">$100 - $500</button>
          <button class="filter-preset" data-amount="500+">$500+</button>
        </div>
        <div class="filter-inputs">
          <div class="filter-input-group">
            <label>Min</label>
            <input type="number" id="filter-amount-min" placeholder="$0" step="0.01">
          </div>
          <div class="filter-input-group">
            <label>Max</label>
            <input type="number" id="filter-amount-max" placeholder="Any" step="0.01">
          </div>
        </div>
      </div>

      <button class="filter-apply" id="filter-apply">Apply Filters</button>
    </div>
  </div>

  <!-- Sort Modal -->
  <div class="filter-modal" id="sort-modal">
    <div class="filter-sheet">
      <div class="filter-sheet-header">
        <h3>Sort By</h3>
        <button id="sort-modal-close">Done</button>
      </div>

      <div class="filter-presets" style="flex-direction: column;">
        <button class="filter-preset active" data-sort="date_desc">Newest First</button>
        <button class="filter-preset" data-sort="date_asc">Oldest First</button>
        <button class="filter-preset" data-sort="amount_desc">Highest Amount</button>
        <button class="filter-preset" data-sort="amount_asc">Lowest Amount</button>
        <button class="filter-preset" data-sort="merchant_asc">Merchant A-Z</button>
      </div>
    </div>
  </div>

  <!-- Upload Modal -->
  <div class="upload-modal" id="upload-modal">
    <div class="upload-content">
      <div class="upload-dropzone" id="upload-dropzone">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="17 8 12 3 7 8"></polyline>
          <line x1="12" y1="3" x2="12" y2="15"></line>
        </svg>
        <h3>Drop receipts here</h3>
        <p>or click to browse</p>
        <p class="upload-formats">JPG, PNG, PDF, HEIC supported</p>
        <input type="file" id="file-input" multiple accept="image/*,.pdf,.heic" style="display: none;">
      </div>
    </div>
  </div>

  <!-- Keyboard Shortcuts Modal -->
  <div class="shortcuts-modal" id="shortcuts-modal">
    <div class="shortcuts-content">
      <h2>Keyboard Shortcuts</h2>
      <div class="shortcuts-grid">
        <div class="shortcut-group">
          <h3>Navigation</h3>
          <div class="shortcut"><span><kbd>J</kbd> / <kbd>K</kbd></span> <span>Next / Prev</span></div>
          <div class="shortcut"><span><kbd>Enter</kbd></span> <span>Open receipt</span></div>
          <div class="shortcut"><span><kbd>Esc</kbd></span> <span>Close / Back</span></div>
        </div>
        <div class="shortcut-group">
          <h3>Actions</h3>
          <div class="shortcut"><span><kbd>/</kbd></span> <span>Search</span></div>
          <div class="shortcut"><span><kbd>F</kbd></span> <span>Favorite</span></div>
          <div class="shortcut"><span><kbd>D</kbd></span> <span>Download</span></div>
        </div>
        <div class="shortcut-group">
          <h3>Views</h3>
          <div class="shortcut"><span><kbd>1</kbd></span> <span>Grid view</span></div>
          <div class="shortcut"><span><kbd>2</kbd></span> <span>List view</span></div>
          <div class="shortcut"><span><kbd>3</kbd></span> <span>Timeline</span></div>
        </div>
        <div class="shortcut-group">
          <h3>Help</h3>
          <div class="shortcut"><span><kbd>?</kbd></span> <span>Show shortcuts</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="/" class="nav-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
        <polyline points="9 22 9 12 15 12 15 22"/>
      </svg>
      <span>Home</span>
    </a>
    <a href="/viewer" class="nav-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 11l3 3L22 4"/>
        <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
      </svg>
      <span>Reconcile</span>
    </a>
    <a href="/library" class="nav-link active">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="7" height="7"/>
        <rect x="14" y="3" width="7" height="7"/>
        <rect x="14" y="14" width="7" height="7"/>
        <rect x="3" y="14" width="7" height="7"/>
      </svg>
      <span>Library</span>
    </a>
    <a href="/incoming" class="nav-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="22 12 16 12 14 15 10 15 8 12 2 12"/>
        <path d="M5.45 5.11L2 12v6a2 2 0 002 2h16a2 2 0 002-2v-6l-3.45-6.89A2 2 0 0016.76 4H7.24a2 2 0 00-1.79 1.11z"/>
      </svg>
      <span>Inbox</span>
    </a>
    <a href="/gmail" class="nav-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
        <polyline points="22,6 12,13 2,6"/>
      </svg>
      <span>Gmail</span>
    </a>
  </nav>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <script src="/static/js/image-utils.js"></script>
  <script src="/static/js/receipt_library.js"></script>
</body>
</html>
